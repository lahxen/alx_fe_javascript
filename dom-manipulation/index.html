<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple DOM Manipulation - Quote Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        .quote-display {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            border-left: 5px solid #667eea;
        }

        #currentQuote {
            font-size: 1.5rem;
            font-style: italic;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        #currentAuthor {
            font-size: 1.1rem;
            color: #667eea;
            font-weight: bold;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px 5px;
            transition: background 0.3s ease;
        }

        button:hover {
            background: #5a6fd8;
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
        }

        .add-quote {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        input, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        textarea {
            height: 80px;
            resize: vertical;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .quote-list {
            margin-top: 20px;
        }

        .quote-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .quote-text {
            font-style: italic;
            margin-bottom: 8px;
        }

        .quote-author {
            color: #667eea;
            font-weight: bold;
        }

        .quote-category {
            color: #888;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        #currentCategory {
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
        }

        .categories-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .categories-section h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }

        #categoriesList {
            margin-top: 10px;
        }

        .category-btn {
            background: #28a745;
            margin: 5px;
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .category-btn:hover {
            background: #218838;
        }

        .quote-actions {
            margin-top: 10px;
        }

        .hidden {
            display: none;
        }

        .filter-section {
            text-align: center;
            margin: 20px 0;
        }

        .filter-label {
            margin-right: 10px;
            font-weight: bold;
        }

        #categoryFilter {
            padding: 8px 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
        }

        #categoryFilter:focus {
            outline: none;
            border-color: #667eea;
        }

        #filterStatus {
            margin-left: 15px;
            color: #666;
            font-size: 0.9rem;
        }

        .storage-info {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #dc3545;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }

        #fileInput {
            display: none;
        }

        .sync-status {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #007bff;
            font-size: 0.9rem;
        }

        .sync-status-header {
            text-align: center;
            margin-bottom: 10px;
        }

        .sync-controls {
            text-align: center;
            margin: 15px 0;
        }

        .sync-controls button {
            margin: 5px;
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        #syncStatus {
            font-weight: bold;
            color: #007bff;
        }

        .conflict-strategy {
            text-align: center;
            margin: 15px 0;
        }

        .sync-statistics {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #cce7ff;
            margin-top: 15px;
        }

        .sync-statistics h4 {
            margin: 0 0 15px 0;
            text-align: center;
            color: #0066cc;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 0.9em;
        }

        .stats-grid div {
            background: white;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .stats-grid span {
            font-weight: bold;
            color: #0066cc;
        }

        .hidden {
            display: none;
        }

        /* Conflict Resolution Modal */
        .conflict-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .conflict-modal-content {
            background: white;
            border-radius: 12px;
            padding: 0;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .conflict-header {
            background: #ff6b6b;
            color: white;
            padding: 20px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .conflict-header h3 {
            margin: 0;
            font-size: 1.2em;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .conflict-body {
            padding: 20px;
        }

        .conflict-preview {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .local-version, .server-version {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
        }

        .local-version {
            border-color: #007bff;
            background: #f8f9ff;
        }

        .server-version {
            border-color: #28a745;
            background: #f8fff8;
        }

        .local-version h4, .server-version h4 {
            margin: 0 0 10px 0;
            color: #333;
        }

        .manual-resolution {
            text-align: center;
            margin-top: 20px;
        }

        .resolution-btn {
            display: inline-block;
            margin: 5px;
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .local-btn {
            background: #007bff;
            color: white;
        }

        .server-btn {
            background: #28a745;
            color: white;
        }

        .merge-btn {
            background: #fd7e14;
            color: white;
        }

        .resolution-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* Notification Toast System */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1100;
            max-width: 350px;
        }

        .notification {
            background: white;
            border-left: 4px solid #007bff;
            border-radius: 6px;
            padding: 15px 20px;
            margin-bottom: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateX(100%);
            animation: slideIn 0.3s ease forwards;
        }

        .notification.success {
            border-left-color: #28a745;
        }

        .notification.warning {
            border-left-color: #ffc107;
        }

        .notification.error {
            border-left-color: #dc3545;
        }

        .notification.conflict {
            border-left-color: #ff6b6b;
            background: #fff5f5;
        }

        @keyframes slideIn {
            to { transform: translateX(0); }
        }

        .notification-title {
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .notification-body {
            color: #666;
            font-size: 0.9em;
        }

        .notification-close {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2em;
            color: #999;
        }

        .notification-actions {
            margin-top: 10px;
            text-align: center;
        }

        .notification-action-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            margin: 0 5px;
            transition: background-color 0.3s ease;
        }

        .notification-action-btn:hover {
            background: #0056b3;
        }

        .manual-resolve-btn {
            background: #ffc107;
            color: #000;
        }

        .manual-resolve-btn:hover {
            background: #e0a800;
        }

        .auto-resolve-btn {
            background: #28a745;
        }

        .auto-resolve-btn:hover {
            background: #1e7e34;
        }

        @keyframes slideOut {
            to { transform: translateX(100%); opacity: 0; }
        }

        /* Step 4: Testing Panel Styles */
        .testing-panel {
            background: #f8f9fa;
            border: 2px solid #007bff;
            border-radius: 10px;
            margin: 20px 0;
            padding: 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .testing-header {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .testing-header h3 {
            margin: 0;
            font-size: 1.1em;
        }

        .testing-content {
            padding: 20px;
        }

        .testing-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .test-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-align: center;
        }

        .full-test {
            background: #007bff;
            color: white;
        }

        .smoke-test {
            background: #28a745;
            color: white;
        }

        .report {
            background: #17a2b8;
            color: white;
        }

        .integrity {
            background: #6f42c1;
            color: white;
        }

        .conflict {
            background: #fd7e14;
            color: white;
        }

        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .test-results {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .test-results h4 {
            margin: 0 0 10px 0;
            color: #495057;
        }

        #testOutput {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            white-space: pre-wrap;
        }

        .verification-checklist {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
        }

        .verification-checklist h4 {
            margin: 0 0 15px 0;
            color: #495057;
        }

        .checklist-items {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .checklist-item.passed {
            background: #d4edda;
            color: #155724;
        }

        .checklist-item.failed {
            background: #f8d7da;
            color: #721c24;
        }

        .checkbox {
            margin-right: 10px;
            font-size: 1.2em;
        }

        .checklist-item.passed .checkbox {
            color: #28a745;
        }

        .checklist-item.failed .checkbox {
            color: #dc3545;
        }

        .test-running {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        /* Conflict History Panel */
        .conflict-history {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin: 20px 0;
            padding: 0;
        }

        .conflict-history-header {
            background: #e9ecef;
            padding: 15px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .conflict-history-header h4 {
            margin: 0;
            color: #495057;
        }

        .toggle-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .conflict-history-list {
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .conflict-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .conflict-item-header {
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 5px;
        }

        .conflict-item-details {
            font-size: 0.85em;
            color: #666;
        }

        .no-conflicts {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            margin: 20px 0;
        }

        .conflict-strategy {
            margin: 10px 0;
            text-align: center;
        }

        .conflict-strategy select {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Simple DOM Manipulation - Quote Generator</h1>
        
        <!-- Quote Display Area -->
        <div class="quote-display">
            <div id="currentQuote">"Click 'Get Random Quote' to start!"</div>
            <div id="currentAuthor">- Quote Generator</div>
            <div id="currentCategory"></div>
        </div>

        <!-- Control Buttons -->
        <div class="controls">
            <button onclick="getRandomQuote()">üé≤ Get Random Quote</button>
            <button onclick="showAddForm()">‚ûï Add New Quote</button>
            <button onclick="exportQuotes()">üíæ Export Quotes</button>
            <button onclick="document.getElementById('fileInput').click()">üìÅ Import Quotes</button>
            <button onclick="clearAllQuotes()">üóëÔ∏è Clear All</button>
            <button onclick="inspectQuotesArray()">üîç Inspect Array</button>
        </div>

        <!-- Server Synchronization Controls -->
        <div class="sync-status">
            <div class="sync-status-header">
                <strong>üåê Server Sync Status:</strong> <span id="syncStatus">Initializing...</span>
            </div>
            <div class="sync-controls">
                <button onclick="triggerManualSync()">üîÑ Manual Sync</button>
                <button onclick="updateOnlineStatus()">üì° Check Connection</button>
                <button onclick="displaySyncStatistics()">üìä Sync Stats</button>
                <button onclick="toggleConflictHistory()">üìã Conflict History</button>
            </div>
            <div class="conflict-strategy">
                <label for="conflictStrategy">‚öñÔ∏è Conflict Resolution:</label>
                <select id="conflictStrategy" onchange="setConflictResolutionStrategy(this.value)">
                    <option value="client-wins">Client Wins</option>
                    <option value="server-wins" selected>Server Wins (Step 2)</option>
                    <option value="merge">Merge</option>
                </select>
            </div>
            <div class="sync-statistics hidden" id="syncStats">
                <h4>üìä Sync Statistics</h4>
                <div class="stats-grid">
                    <div>Total Syncs: <span id="totalSyncs">0</span></div>
                    <div>Conflicts Detected: <span id="conflictsCount">0</span></div>
                    <div>Server Wins: <span id="serverWinsCount">0</span></div>
                    <div>Data Changes: <span id="dataChangesCount">0</span></div>
                </div>
            </div>
        </div>

        <!-- Category Filter Dropdown -->
        <div class="filter-section">
            <label for="categoryFilter" class="filter-label">üè∑Ô∏è Filter by Category:</label>
            <select id="categoryFilter" onchange="filterQuotes()">
                <option value="all">All Categories</option>
                <!-- Dynamically populated categories -->
            </select>
            <span id="filterStatus"></span>
        </div>

        <!-- Categories Display -->
        <div class="categories-section">
            <h3>üìÇ Browse by Category:</h3>
            <div id="categoriesList"></div>
        </div>

        <!-- Hidden file input for import -->
        <input type="file" id="fileInput" accept=".json" onchange="importQuotes(event)">

        <!-- Add Quote Form (hidden by default) -->
        <div id="addQuoteForm" class="add-quote hidden">
            <h3>Add Your Own Quote</h3>
            <div class="form-group">
                <label for="quoteText">Quote:</label>
                <textarea id="quoteText" placeholder="Enter your quote here..."></textarea>
            </div>
            <div class="form-group">
                <label for="quoteAuthor">Author:</label>
                <input type="text" id="quoteAuthor" placeholder="Enter author name">
            </div>
            <div class="form-group">
                <label for="quoteCategory">Category:</label>
                <input type="text" id="quoteCategory" placeholder="Enter category (e.g., motivation, wisdom, life)">
            </div>
            <button onclick="addQuote()">‚úÖ Save Quote</button>
            <button onclick="hideAddForm()">‚ùå Cancel</button>
        </div>

        <!-- Conflict Resolution Modal -->
        <div class="conflict-modal hidden" id="conflictModal">
            <div class="conflict-modal-content">
                <div class="conflict-header">
                    <h3>‚ö†Ô∏è Data Conflict Detected</h3>
                    <button class="close-btn" onclick="closeConflictModal()">‚úï</button>
                </div>
                <div class="conflict-body">
                    <p id="conflictMessage">Conflicts detected between local and server data.</p>
                    <div class="conflict-options">
                        <div class="conflict-preview">
                            <div class="local-version">
                                <h4>üì± Local Version</h4>
                                <div id="localConflictData"></div>
                            </div>
                            <div class="server-version">
                                <h4>üåê Server Version</h4>
                                <div id="serverConflictData"></div>
                            </div>
                        </div>
                        <div class="manual-resolution">
                            <h4>üõ†Ô∏è Manual Resolution Options</h4>
                            <button onclick="resolveConflictManually('keep-local')" class="resolution-btn local-btn">
                                üì± Keep Local Version
                            </button>
                            <button onclick="resolveConflictManually('accept-server')" class="resolution-btn server-btn">
                                üåê Accept Server Version
                            </button>
                            <button onclick="resolveConflictManually('merge-both')" class="resolution-btn merge-btn">
                                üîÄ Merge Both Versions
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification Toast System -->
        <div class="notification-container" id="notificationContainer"></div>

        <!-- Conflict History Panel -->
        <div class="conflict-history hidden" id="conflictHistory">
            <div class="conflict-history-header">
                <h4>üìã Recent Conflicts & Resolutions</h4>
                <button onclick="toggleConflictHistory()" class="toggle-btn">Hide</button>
            </div>
            <div class="conflict-history-list" id="conflictHistoryList">
                <p class="no-conflicts">No conflicts detected yet.</p>
            </div>
        </div>

        <!-- Storage Information -->
        <div id="storageInfo" class="storage-info">
            <strong>üìä Storage Info:</strong>
            <div>Total Quotes: <span id="quoteCount">0</span></div>
            <div>Last Action: <span id="lastAction">Page loaded</span></div>
        </div>

        <!-- Step 4: Testing and Verification Panel -->
        <div class="testing-panel" id="testingPanel">
            <div class="testing-header">
                <h3>üß™ Step 4: Testing & Verification</h3>
                <button onclick="toggleTestingPanel()" class="toggle-btn" id="testToggleBtn">Show</button>
            </div>
            <div class="testing-content hidden" id="testingContent">
                <div class="testing-controls">
                    <button onclick="runFullTests()" class="test-btn full-test">üî¨ Run Full Test Suite</button>
                    <button onclick="runSmokeTests()" class="test-btn smoke-test">üí® Quick Smoke Test</button>
                    <button onclick="showTestReport()" class="test-btn report">üìä View Test Report</button>
                    <button onclick="verifyDataIntegrity()" class="test-btn integrity">üîí Verify Data Integrity</button>
                    <button onclick="simulateConflictScenario()" class="test-btn conflict">‚öîÔ∏è Simulate Conflicts</button>
                </div>
                <div class="test-results" id="testResults">
                    <h4>Test Results</h4>
                    <div id="testOutput">No tests run yet. Click a test button to begin.</div>
                </div>
                <div class="verification-checklist" id="verificationChecklist">
                    <h4>Verification Checklist</h4>
                    <div class="checklist-items">
                        <div class="checklist-item" id="check-sync">
                            <span class="checkbox">‚≠ï</span> Server Sync Functionality
                        </div>
                        <div class="checklist-item" id="check-conflicts">
                            <span class="checkbox">‚≠ï</span> Conflict Detection & Resolution
                        </div>
                        <div class="checklist-item" id="check-data-integrity">
                            <span class="checkbox">‚≠ï</span> Data Integrity & No Data Loss
                        </div>
                        <div class="checklist-item" id="check-merge">
                            <span class="checkbox">‚≠ï</span> Proper Data Merging
                        </div>
                        <div class="checklist-item" id="check-ui">
                            <span class="checkbox">‚≠ï</span> UI Response & Notifications
                        </div>
                        <div class="checklist-item" id="check-storage">
                            <span class="checkbox">‚≠ï</span> Storage Persistence
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- All Quotes Display -->
        <div class="quote-list">
            <h3>üìù All Your Quotes:</h3>
            <div id="allQuotes"></div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="test-suite.js"></script>
</body>
</html>
